import { getFetchRequestOptions } from '../apiFetch';

global.FormData = jest.fn();

describe('getFetchRequestOptions', () => {
  test('creates a `header` key with authorization data', () => {
    const auth = {
      email: 'john@example.com',
      apiKey: 'some_key',
    };
    const params = {};

    const actualResult = getFetchRequestOptions(auth, params);

    expect(actualResult.headers).toBeTruthy();
    expect(actualResult.headers.Authorization).toBeTruthy();
  });

  test('merges `headers` key and all given params into a new object', () => {
    const auth = {
      email: 'john@example.com',
      apiKey: 'some_key',
    };
    const params = {
      key: 'value',
    };

    const actualResult = getFetchRequestOptions(auth, params);

    expect(actualResult.key).toBe('value');
  });

  test('when no apiKey provided does not return `Authorization` headers key', () => {
    const auth = {
      email: 'john@example.com',
      apiKey: '',
    };
    const params = {};

    const actualResult = getFetchRequestOptions(auth, params);

    expect(actualResult.headers).toBeTruthy();
    expect(actualResult.headers.Authorization).toBeUndefined();
  });
});
